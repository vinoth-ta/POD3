You must not modify any part of the notebook except the section between the below markers:
# START_SPARK_SQL_TRANSFORMATIONS
transform_sql_query_dict = {{
        target_table_nm: {{
            "sql": """                
                SELECT bronze.* FROM (<sqlTransformation>
                FROM bronze_data WHERE ROWNUM = 1) bronze
                LEFT JOIN (SELECT * FROM {{target_db_name}}.{{target_table_nm}} WHERE XTNDFSystemId = {{bronzeSystemId}} and XTNDFReportingUnitId = {{bronzeReportingId}}) silver 
		        ON bronze.<target_join_column> = silver.<target_join_column>
                AND bronze.<target_join_column> = silver.<target_join_column>
		        WHERE bronze.<target_audit_column> > COALESCE(silver.<target_audit_column>, '1970-01-01 00:00:00')
                """.format(target_db_name=target_db_nm,**widgetParams),
            "merge_key": """<merge_key>""",
			"partition_columns": """<partition_cols>""",
			"merge_type": """<merge_type>""",
			"format_type": """delta""",
			"output_directory_name": f"silver/database/{{target_table_nm}}"
        }}
    }}
# END_SPARK_SQL_TRANSFORMATIONS

### Requirements:
Remove all ```json```, ```sql```, ```python``,` or `````` from output
Do not edit target_table_nm as this is a Parameter already provided
Define SQL SELECT statement inside the `sql` key of transform_sql_query_dict['target_table_nm']
If source_datatype is different from target_datatype than cast the value to it's target_datatype
Do not change the FROM bronze_data WHERE ROWNUM = 1 as this is fixed logic
Replace <target_join_column> with the values from STTM['target_table']['metadata']['target_join_columns'] and not from 'merge_key'
Replace <target_audit_column> with the values from STTM['target_table']['metadata']['target_audit_columns']
Do not rename columns unless source and target column are different from the STTM
The following Audit columns must be selected directly from the source table:
- XTNDFSystemId
- XTNDFReportingUnitId
- XTNCreatedTime
- XTNCreatedById
- XTNUpdatedTime
- XTNUpdatedById
The .format(target_db_name=target_db_name,**widgetParams) is fixed logic and should never be changed
Replace <merge_key> with the values from STTM['target_table']['metadata']['merge_key']
Replace <partition_cols> with the values from STTM['target_table']['metadata']['partition_columns']
Replace <merge_type> with the values from STTM['target_table']['metadata']['merge_type']
Do not edit output_directory_name value from `sql` key of transform_sql_query_dict['target_table_nm']


### Output:
Return the result strictly as transform_sql_query_dict = JSON, do not include any explanation, markdown, or code fencing.
Only the SQL code between the below markers, nothing else:
# START_SPARK_SQL_TRANSFORMATIONS
# END_SPARK_SQL_TRANSFORMATIONS